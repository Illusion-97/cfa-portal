{"remainingRequest":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\src\\views\\Etudiant\\EspaceAdministratif\\DepotFichier.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\src\\views\\Etudiant\\EspaceAdministratif\\DepotFichier.vue","mtime":1634717085246},{"path":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1634732405246},{"path":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\node_modules\\babel-loader\\lib\\index.js","mtime":1634732404052},{"path":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1634732405246},{"path":"C:\\Users\\Admin stagiaire.DESKTOP-8967908\\Desktop\\Projet_CFA\\AppliCFAFront\\cfa-portal\\node_modules\\vue-loader\\lib\\index.js","mtime":1634732415295}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBmaWxlQXBpIH0gZnJvbSAiQC9fYXBpL2ZpbGUuYXBpLmpzIg0KaW1wb3J0IEJvZHlUaXRsZSBmcm9tICJAL2NvbXBvbmVudHMvdXRpbHMvQm9keVRpdGxlLnZ1ZSI7DQppbXBvcnQgeyBmaWxlRmllbGRzIH0gZnJvbSAiQC9hc3NldHMvanMvZmllbGRzLmpzIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkRlcG90RmljaGllciIsDQogIGNvbXBvbmVudHM6IHsNCiAgICBCb2R5VGl0bGUsDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGZpbGVzOiBbXSwNCiAgICAgIGZpZWxkczogZmlsZUZpZWxkcywNCiAgICAgIHBlcl9wYWdlOiAxMCwNCiAgICAgIGN1cnJlbnRQYWdlOiAxLA0KICAgICAgZmlsZTogIiIsDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBpdGVtcygpIHsNCiAgICAgIGxldCByZXN1bHQgPSBbXTsgICAgICANCiAgICAgIA0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZpbGVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGxldCB0YWJsZSA9IHsgbmFtZTogIiIsIG5hbWVfZGw6ICIiLCBuYW1lX2RlbGV0ZTogIiIgfTsNCg0KICAgICAgICB0YWJsZS5uYW1lID0gdGhpcy5maWxlc1tpXTsNCiAgICAgICAgdGFibGUubmFtZV9kbCA9IHRoaXMuZmlsZXNbaV07DQogICAgICAgIHRhYmxlLm5hbWVfZGVsZXRlID0gdGhpcy5maWxlc1tpXTsNCg0KICAgICAgICByZXN1bHQucHVzaCh0YWJsZSk7DQogICAgICB9DQoNCiAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSwNCiAgICByb3dzKCkgew0KICAgICAgcmV0dXJuIHRoaXMuaXRlbXMubGVuZ3RoOw0KICAgIH0sDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBoYW5kbGVGaWxlVXBsb2FkKCkgew0KICAgICAgdGhpcy5maWxlID0gdGhpcy4kcmVmcy5maWxlLmZpbGVzWzBdOw0KICAgIH0sDQogICAgc3VibWl0RmlsZSgpIHsgICAgICAgIA0KICAgICAgZmlsZUFwaS5zdWJtaXRGaWxlQnlEaXJlY3RvcnlBbmRJZCgidXRpbGlzYXRldXJzIiwgdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRVdGlsaXNhdGV1ci5pZCwgdGhpcy5maWxlKS50aGVuKCgpID0+IHRoaXMubGlzdF9yZXNldCgpKTsNCiAgICB9LA0KICAgIGxpc3RfcmVzZXQoKSB7DQogICAgICBmaWxlQXBpLmdldExpc3RCeURpcmVjdG9yeUFuZElkKCJ1dGlsaXNhdGV1cnMiLHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0VXRpbGlzYXRldXIuaWQpLnRoZW4oKHJlc3BvbnNlKSA9PiB0aGlzLmZpbGVzID0gcmVzcG9uc2UpOw0KICAgIH0sDQogICAgZG93bmxvYWRfZmlsZShmaWxlTmFtZSkgew0KICAgICAgZmlsZUFwaS5kb3dubG9hZEJ5RGlyZWN0b3J5QW5kSWRBbmRGaWxlbmFtZSgidXRpbGlzYXRldXJzIiwgdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRVdGlsaXNhdGV1ci5pZCwgZmlsZU5hbWUpOw0KICAgIH0sDQogICAgZGVsZXRlX2ZpbGUoZmlsZU5hbWUpIHsNCiAgICAgIGZpbGVBcGkuZGVsZXRlQnlEaXJlY3RvcnlBbmRJZEFuZEZpbGVuYW1lKCJ1dGlsaXNhdGV1cnMiLCB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFV0aWxpc2F0ZXVyLmlkLCBmaWxlTmFtZSkudGhlbigoKSA9PiB0aGlzLmxpc3RfcmVzZXQoKSk7DQogICAgfSwNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmxpc3RfcmVzZXQoKTsNCiAgfSwNCn07DQo="},{"version":3,"sources":["DepotFichier.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DepotFichier.vue","sourceRoot":"src/views/Etudiant/EspaceAdministratif","sourcesContent":["<template>\r\n  <div>\r\n    <BodyTitle title=\"Liste des documents administratifs\" />\r\n\r\n    <div class=\"container mt-5\">\r\n      <div class=\"row\">\r\n        <div class=\"\">\r\n          <input\r\n            type=\"file\"\r\n            id=\"file\"\r\n            ref=\"file\"\r\n            v-on:change=\"handleFileUpload()\"\r\n            class=\"mr-3\"\r\n            accept=\"application/pdf\"\r\n          />\r\n          <button v-on:click=\"submitFile()\" class=\"btn btn-primary\">Ajouter</button>\r\n        </div>\r\n        <div class=\"my-3 ml-auto col-md-3\" v-if=\"items.length != 0\">\r\n            <b-form inline>\r\n              <label for=\"pageSelect\" class=\"mr-sm-2\">Affichage :</label>\r\n              <b-form-select id=\"pageSelect\" v-model=\"per_page\" class=\"border-0 opts\" size=\"sm\">\r\n                <b-form-select-option :value=\"Math.floor(items.length * 0.25)\">\r\n                  {{ (items.length * 0.25) | formatNumber }} sur\r\n                  {{ items.length }}\r\n                </b-form-select-option>\r\n                <b-form-select-option :value=\"Math.floor(items.length * 0.5)\">\r\n                  {{ (items.length * 0.5) | formatNumber }} sur\r\n                  {{ items.length }}\r\n                </b-form-select-option>\r\n                <b-form-select-option :value=\"Math.floor(items.length * 0.75)\">\r\n                  {{ (items.length * 0.75) | formatNumber }} sur\r\n                  {{ items.length }}\r\n                </b-form-select-option>\r\n                <b-form-select-option :value=\"items.length\">\r\n                  Tout afficher\r\n                </b-form-select-option>\r\n              </b-form-select>\r\n            </b-form>\r\n          </div>\r\n        <b-table\r\n          id=\"my-table\"\r\n          striped\r\n          small\r\n          :items=\"items\"\r\n          :fields=\"fields\"\r\n          :per-page=\"per_page\"\r\n          :current-page=\"currentPage\"\r\n        >\r\n          <template #cell(name_dl)=\"data\">\r\n            <font-awesome-icon\r\n              :icon=\"['fas', 'arrow-down']\"\r\n              class=\"icon text-success\"\r\n              @click=\"download_file(data.value)\"\r\n            />\r\n          </template>\r\n\r\n          <template #cell(name_delete)=\"data\">\r\n            <font-awesome-icon\r\n              :icon=\"['fas', 'times']\"\r\n              class=\"icon text-danger\"\r\n              @click=\"delete_file(data.value)\"\r\n            />\r\n          </template>\r\n        </b-table>\r\n        <b-pagination\r\n          class=\"pages ml-auto border-0\"\r\n          v-model=\"currentPage\"\r\n          :total-rows=\"rows\"\r\n          :per-page=\"per_page\"\r\n          aria-controls=\"my-table\"\r\n          size=\"sm\"\r\n        >\r\n        </b-pagination>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fileApi } from \"@/_api/file.api.js\"\r\nimport BodyTitle from \"@/components/utils/BodyTitle.vue\";\r\nimport { fileFields } from \"@/assets/js/fields.js\";\r\nexport default {\r\n  name: \"DepotFichier\",\r\n  components: {\r\n    BodyTitle,\r\n  },\r\n  data() {\r\n    return {\r\n      files: [],\r\n      fields: fileFields,\r\n      per_page: 10,\r\n      currentPage: 1,\r\n      file: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    items() {\r\n      let result = [];      \r\n      \r\n      for (let i = 0; i < this.files.length; i++) {\r\n        let table = { name: \"\", name_dl: \"\", name_delete: \"\" };\r\n\r\n        table.name = this.files[i];\r\n        table.name_dl = this.files[i];\r\n        table.name_delete = this.files[i];\r\n\r\n        result.push(table);\r\n      }\r\n\r\n      return result;\r\n    },\r\n    rows() {\r\n      return this.items.length;\r\n    },\r\n  },\r\n  methods: {\r\n    handleFileUpload() {\r\n      this.file = this.$refs.file.files[0];\r\n    },\r\n    submitFile() {        \r\n      fileApi.submitFileByDirectoryAndId(\"utilisateurs\", this.$store.getters.getUtilisateur.id, this.file).then(() => this.list_reset());\r\n    },\r\n    list_reset() {\r\n      fileApi.getListByDirectoryAndId(\"utilisateurs\",this.$store.getters.getUtilisateur.id).then((response) => this.files = response);\r\n    },\r\n    download_file(fileName) {\r\n      fileApi.downloadByDirectoryAndIdAndFilename(\"utilisateurs\", this.$store.getters.getUtilisateur.id, fileName);\r\n    },\r\n    delete_file(fileName) {\r\n      fileApi.deleteByDirectoryAndIdAndFilename(\"utilisateurs\", this.$store.getters.getUtilisateur.id, fileName).then(() => this.list_reset());\r\n    },\r\n  },\r\n  created() {\r\n    this.list_reset();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.form {\r\n  border: 1px solid #6c757d;\r\n  margin-top: 5em;\r\n  padding-top: 2em;\r\n  padding-left: 5em;\r\n  padding-right: 5em;\r\n}\r\n\r\n.b-form-textarea {\r\n  height: 200px;\r\n}\r\n\r\n#my-table {\r\n  text-align: center;\r\n}\r\n\r\n.icon:hover{\r\n  cursor: pointer;\r\n}\r\n</style>\r\n"]}]}